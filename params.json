{"name":"Dashing-jenkins job","tagline":"Jenkins widget for Dashing-JS","body":"# Jenkins Job Dashing widget\r\n\r\nAuthor: [Julian Kleinhans](https://github.com/kj187) Â· Blog: [http://blog.kj187.de](http://blog.kj187.de)\r\n\r\n[Dashing-JS](https://github.com/fabiocaseri/dashing-js) is a NodeJS port of [Dashing](http://dashing.io/), an Sinatra based framework that lets you build beautiful dashboards.\r\n\r\nThe [Jenkins](https://jenkins-ci.org/) Job widget is a generic widget for Jenkins jobs which provides a highly visible view of the build status and build progress of selected Jenkins jobs. Via configuration it is possible to add multiple widgets for different Jenkins jobs.\r\n\r\n## Preview\r\n![example 1](http://res.cloudinary.com/kj187/image/upload/v1450128665/example_01_xri70k.png)\r\n![example 2](http://res.cloudinary.com/kj187/image/upload/v1450128664/example_02_lzhqfv.png) \r\n\r\n### Reallife example\r\nHere you can see what you can achive only with Dashing-JS and this Jenkins Job widget.\r\n\r\n![Dashboard example](http://res.cloudinary.com/kj187/image/upload/c_scale,w_890/v1450212394/kj187_Dashboard_2_i4wkw6.png)\r\n\r\nWith other third party widgets\r\n![Example](http://res.cloudinary.com/kj187/image/upload/v1453152816/dashboard_example_stb2dc.png)\r\n\r\n## Requirements\r\n\r\n[Dashing-JS](https://github.com/fabiocaseri/dashing-js)\r\n```ssh\r\n$ npm install -g dashing-js\r\n```\r\n\r\nJenkins Job Widget dependencies\r\n```shell\r\n$ npm install jenkins-api\r\n$ npm install cron\r\n$ npm install moment\r\n$ npm install request\r\n$ npm install memory-cache\r\n```\r\n\r\n## Installation\r\n```shell\r\n$ dashing-js install https://github.com/kj187/dashing-jenkins_job/archive/master.zip\r\n``` \r\nCreate a new directory `config` on your root directory.\r\nMove the `widgets/jenkins_job/config.jenkins_job.sample.js` file to this directory and rename it to `config.jenkins_job.js`.\r\n \r\n```\r\nassets/\r\n  ...\r\nconfig/\r\n  config.jenkins_job.js\r\n  ...\r\ndashboards/\r\n  ...\r\njobs/\r\n  ...\r\n...\r\n```\r\n\r\nThe progressbar requires the jQueryUI styles and javascript lib. Add the following lines to your `dashboards/layout.ejs`\r\n\r\n```html\r\n<script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js\"></script>\r\n<link rel=\"stylesheet\" href=\"//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.css\">\r\n```\r\n\r\nor if you use Jade as your favorite template engine\r\n```jade\r\nscript(src='//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js')\r\nlink(rel='stylesheet', href='//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.css')\r\n```\r\n\r\n## Usage\r\nTo include the widget on your dashboard, add the following snippet to the dashboard layout file:\r\n\r\n```html\r\n<li data-row=\"1\" data-col=\"1\" data-sizex=\"1\" data-sizey=\"1\" class=\"widget-jenkins_job\">\r\n  <div data-id=\"build\" data-view=\"JenkinsJob\" data-bind-class=\"result | append additionalclass\" data-additionalclass=\" widget\"></div>\r\n  <i class=\"fa fa-archive icon-background\"></i>\r\n</li>\r\n```\r\nOr again, if you use Jade as your favorite template engine \r\n```jade\r\nli(data-row='1', data-col='1', data-sizex='1', data-sizey='1', class='widget-jenkins_job')\r\n  div(data-id='build', data-view='JenkinsJob', data-bind-class='result | append additionalclass', data-additionalclass=' widget')\r\n  i(class='fa fa-archive icon-background')\r\n```\r\n\r\nYou can add multiple widgets for different Jenkins jobs. Each widget must have his own unqiue `data-id`. My suggestion is to get the Jenkins job name for `data-id`. \r\n\r\n## Settings\r\n\r\nTo actually use the widget on your own Dashboard, you'll have to have an access token from your Jenkins server. If you don`t have an access token you can also use your username and password. \r\n\r\n### Minimum settings example\r\n```javascript\r\nmodule.exports = {\r\n\r\n    protocol: 'https',\r\n    username: 'YOUR_JENKINS_USERNAME',\r\n    token: 'YOUR_JENKINS_ACCESS_TOKEN_OR_PLAINTEXT_PASSWORD',\r\n    host: 'YOUR_JENKINS_HOST',\r\n\r\n    jobs: [\r\n        {\r\n            id: 'build',\r\n            displayName: 'Build',\r\n            eventName: 'build',\r\n            cronInterval: '*/1 * * * * *',\r\n            apiMethod: 'last_build_info',\r\n\r\n            displayArguments: {\r\n                title_isEnabled: true,\r\n                buildNumber_isEnabled: true,\r\n                timeAgo_isEnabled: true,\r\n                branch_isEnabled: true,\r\n                displayDuration_isEnabled: true\r\n            },\r\n        },\r\n    ]\r\n}\r\n```\r\n\r\n### Reallife settings example\r\n```javascript\r\n\r\nmodule.exports = {\r\n\r\n    protocol: 'https',\r\n    username: 'YOUR_JENKINS_USERNAME',\r\n    token: 'YOUR_JENKINS_ACCESS_TOKEN_OR_PLAINTEXT_PASSWORD',\r\n    host: 'YOUR_JENKINS_HOST',\r\n\r\n    jobs: [\r\n        {\r\n            id: 'build',\r\n            displayName: 'Build',\r\n            eventName: 'build',\r\n            cronInterval: '*/1 * * * * *',\r\n            apiMethod: 'last_build_info',\r\n\r\n            displayArguments: {\r\n                title_isEnabled: true,\r\n                buildNumber_isEnabled: true,\r\n                timeAgo_isEnabled: true,\r\n                branch_isEnabled: true,\r\n                displayDuration_isEnabled: true\r\n            },\r\n\r\n            parameterizedAttributes: [\r\n                {\r\n                    attributeName: 'branch',\r\n                    jenkinsParameterName: 'BRANCH_TO_BUILD'\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            id: 'static_code_analysis',\r\n            displayName: 'Static Code Analysis',\r\n            eventName: 'static_code_analysis',\r\n            cronInterval: '*/1 * * * * *',\r\n            apiMethod: 'last_build_info',\r\n        \r\n            displayArguments: {\r\n                title_isEnabled: true,\r\n                buildNumber_isEnabled: false,\r\n                timeAgo_isEnabled: true,\r\n                branch_isEnabled: false,\r\n                displayDuration_isEnabled: true\r\n            }\r\n        },\r\n        {\r\n            id: 'install_latest',\r\n            displayName: 'Install Latest',\r\n            eventName: 'install_latest',\r\n            cronInterval: '*/1 * * * * *',\r\n            apiMethod: 'last_build_info',\r\n        \r\n            externalBuildNumber: {\r\n               url: 'http://latest.your_application_url.host/build.txt'\r\n            },\r\n        \r\n            displayArguments: {\r\n                title_isEnabled: true,\r\n                buildNumber_isEnabled: true,\r\n                timeAgo_isEnabled: true,\r\n                branch_isEnabled: false,\r\n                displayDuration_isEnabled: true\r\n            }\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n### Jenkins settings\r\n| Setting       | Example           | Description |\r\n| ------------- |-------------| -----|\r\n| protocol      | https   | Http protocol of your Jenkins server |\r\n| username      | julian.kleinhans   | Username for authentication |\r\n| token         | ABCDEFG12345JHKLLAIJJ   | Access token or plaintext password for authentication |\r\n| host      | jenkins-ci.kj187.de   | Host of your Jenkins server |\r\n\r\n#### jobs\r\nYou can define multiple jobs, keep in mind to add the html snippet in your dashboard layout file\r\n\r\n| Setting       | Example           | Description |\r\n| ------------- |-------------| -----|\r\n| id      | build   | Jenkins job name |\r\n| displayName      | Build    | Widget title  |\r\n| eventName      | build   | Event name, must be the same as the `data-id` attribute |\r\n| cronInterval      | */1 * * * * *   | Click [here](https://github.com/ncb000gt/node-cron) for available cron patterns |\r\n| apiMethod      | last_build_info   | Jenkins API method. Don`t change this value! |\r\n\r\n##### displayArguments\r\ndisplayArguments gives you the possibility to show or hide some parts in your widget\r\n\r\n| Setting       | Example           | Description |\r\n| ------------- |-------------| -----|\r\n| title_isEnabled      | true   | Show title |\r\n| buildNumber_isEnabled      | true   | Show buildnumber |\r\n| timeAgo_isEnabled      | true   | Show time of last execution  |\r\n| branch_isEnabled      | false   | Don`t show the branch name  |\r\n| displayDuration_isEnabled      | true   | Show the duration time  |\r\n\r\n##### parameterizedAttributes\r\nIn Jenkins it is possible to create your own attributes (parameterized attributes). With this array it is possible to read this dynamical attributes and bind them onto a variable. \r\n\r\n| Setting       | Example           | Description |\r\n| ------------- |-------------| -----|\r\n| attributeName      | branch   | Attribute name which is available for the `data-bind` argument |\r\n| jenkinsParameterName      | BRANCH_TO_BUILD   | The name of your own Jenkins parameter |\r\n\r\n##### externalBuildNumber\r\nImagine that you have two Jenkins jobs. A build job, which creates an build artifact and an install job, which installs the build artifact on a server. Each job has his own buildnumber. But, for the second install job, we would like to know which build artifact - from the first jenkins job - was installed. With this setting you can get the installed buildnumber via an text file. This requires that you have created an build.txt file in the first job and it was also deployed on your target node. \r\n\r\n| Setting       | Example           | Description |\r\n| ------------- |-------------| -----|\r\n| url      | http://latest.your_application_url.host/build.txt   | Text file URL which includes only the buildnumber of an artifact which is installed on that node |\r\n\r\nTo create a build.txt file is quite simple, just add the follwing line to your Jenkins job where you build the artifact. \r\n\r\n```ssh \r\necho \"${BUILD_NUMBER}\" > artifacts/build.txt\r\n```\r\n\r\n`BUILD_NUMBER` is an global Jenkins variable, which includes the current build number. Make sure to deploy this file into the DOCUMENT_ROOT of your target node, so that it is reachable with an URL like http://latest.your_application_url.host/build.txt\r\n\r\n## Layout\r\n\r\n### Half sized widgets\r\nThe Jenkins Job widget provides you also the possibility to show a widget in the half size, so instead of one normal widget you can display two small widgets.  \r\n\r\n##### Example\r\n![Two rows long](http://res.cloudinary.com/kj187/image/upload/c_scale,w_890/v1450184400/2row1_huxdlu.png )\r\n![Two rows small](http://res.cloudinary.com/kj187/image/upload/c_scale,w_890/v1450184429/2row2_aeatcw.png ) \r\n\r\n##### HTML\r\nJust switch your dashboard HTML to the following\r\n\r\n```HTML\r\n<li data-row=\"1\" data-col=\"3\" data-sizex=\"2\" data-sizey=\"1\">\r\n  <div class=\"widget-jenkins_job two-row-container\">\r\n    <div data-id=\"grunt_deploy\" data-view=\"JenkinsJob\" data-bind-class=\"result | prepend additionalclass\" data-additionalclass=\"widget two-row-widget \"></div>\r\n    <i class=\"fa fa-code icon-background\"></i>\r\n  </div>\r\n  <div class=\"widget-jenkins_job two-row-container\">\r\n    <div data-id=\"create_backup\" data-view=\"JenkinsJob\" data-bind-class=\"result | prepend additionalclass\" data-additionalclass=\"widget two-row-widget \"></div>\r\n    <i class=\"fa fa-dropbox icon-background fa-3\"></i>\r\n  </div>\r\n</li>\r\n```\r\n\r\nOr if you use Jade\r\n```jade\r\nli(data-row='1', data-col='2', data-sizex='1', data-sizey='1')\r\n  div(class='widget-jenkins_job two-row-container')\r\n    div(data-id='grunt_deploy', data-view='JenkinsJob', data-bind-class='result | prepend additionalclass', data-additionalclass='widget two-row-widget ')\r\n    li(class='fa fa-code icon-background')\r\n  div(class='widget-jenkins_job two-row-container')\r\n    div(data-id='create_backup', data-view='JenkinsJob', data-bind-class='result | prepend additionalclass', data-additionalclass='widget two-row-widget ')\r\n    li(class='fa fa-code icon-background')\r\n```\r\n\r\nThe first example uses a `data-sizex=\"2\"` attribute and the second `data-sizex=\"1\"`.\r\n\r\n### List style with multiple widgets\r\nThe Jenkins Job widget provides you also the possibility to show multiple widgets as a list. You can also set a container headline. One use case could be to collect all jobs from a node. \r\n\r\n##### Example\r\n![List example](http://res.cloudinary.com/kj187/image/upload/c_scale,w_890/v1450211615/kj187_Dashboard_rjo4ak.png)\r\n\r\n##### HTML\r\nJust switch your dashboard HTML to the following\r\n\r\n```HTML\r\n<li data-row=\"2\" data-col=\"1\" data-sizex=\"2\" data-sizey=\"1\">\r\n  <div class=\"widget-jenkins_job widget container\">\r\n    <h1 class=\"stackTitle\">Title</h1>\r\n    <div class=\"widget-jenkins_job item\">\r\n      <div data-id=\"install_latest\" data-view=\"JenkinsJob\" data-bind-class=\"result | append additionalclass\" data-additionalclass=\" widget\"></div>\r\n      <i class=\"fa fa-cog icon-background\"></i>\r\n    </div>\r\n    <div class=\"widget-jenkins_job item\">\r\n      <div data-id=\"unittest_latest\" data-view=\"JenkinsJob\" data-bind-class=\"result | append additionalclass\" data-additionalclass=\" widget\"></div>\r\n      <i class=\"fa fa-shield icon-background\"></i>\r\n    </div>\r\n    <!-- ... -->\r\n  </div>\r\n</li>\r\n```\r\n\r\nOr if you use Jade\r\n```jade\r\nli(data-row='1', data-col='1', data-sizex='1', data-sizey='1')\r\n  div(class='widget-jenkins_job widget container')\r\n    h1(title='Titel', class='stackTitle')\r\n    div(class='widget-jenkins_job item')\r\n      div(data-id='install_latest', data-view='JenkinsJob', data-bind-class='result | prepend additionalclass', data-additionalclass='widget ')\r\n      li(class='fa fa-code icon-background')\r\n    div(class='widget-jenkins_job item')\r\n      div(data-id='unittest_latest', data-view='JenkinsJob', data-bind-class='result | prepend additionalclass', data-additionalclass='widget ')\r\n      li(class='fa fa-shield icon-background')\r\n    // ...\r\n```\r\n\r\nHave fun :-)\r\n\r\n## Changelog\r\n### release-1.1.0\r\n* Add caching for externalBuildNumber. You have to install \"memory-cache\" via npm\r\n* Add stackTitle class\r\n \r\n### release-1.0.0\r\n* First release\r\n\r\n## Other Dashing-JS widgets\r\nDo you know that I also created some other Dashing-JS widgets? Try out\r\n\r\n* [Jenkins Job widget](http://kj187.github.io/dashing-jenkins_job/)\r\n* [Meeting Reminder widget](http://kj187.github.io/dashing-reminder)\r\n* [GitHub PullRequest widget](http://kj187.github.io/dashing-github_pullrequests/)\r\n* [TargetProcess Impediments widget](http://kj187.github.io/dashing-targetprocess_impediments/)\r\n* [TargetProcess Sprint widget](http://kj187.github.io/dashing-targetprocess_sprint/)\r\n* [TargetProcess Burndown widget](http://kj187.github.io/dashing-targetprocess_burndown/)\r\n","google":"UA-71424242-1","note":"Don't delete this file! It's used internally to help with page regeneration."}